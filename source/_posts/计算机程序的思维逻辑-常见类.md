title: 计算机程序的思维逻辑-常见类
tags:
    - Java
    - 笔记
    - 基础知识
comments: true
date: 2017-4-15
brief: 基础知识
categories:
    - 笔记
---
# [笔记]计算机思维逻辑-常见类
计算机程序的思维逻辑是“老马”的系列文章，文章通过Java语言来介绍计算机技术的本质。第三章节常见类,介绍了包装类的共性，hashCode作用，String、StringBuilder的内部表示,Arrays常用的方法,时间日期常用方法，Joda-Time计算时间，随机种子等概念。
[原文目录(26-34章)](http://www.cnblogs.com/swiftma/p/5631311.html)

<!-- more -->

## 剖析包装类
对两个对象，如果equals方法返回true，则hashCode也必须一样,反过来却不一定。

哈希值是一个int类型的数，由对象中一般不变的属性映射得来，用于快速对对象进行区分、分组等

包装类都实现了Comparable接口；都具有,如parseInteger(String[,Integer])静态方法(可解析,数值类型),将字符串解析为对应的基本类型。还有输出为各种进制的字符串toBinaryString(),toHexString()；具有与基本类型相关的常量

包装类常用常量
```js
//Integer
public static final int   MIN_VALUE = 0x80000000;
public static final int   MAX_VALUE = 0x7fffffff;
//Float,Double
public static final double POSITIVE_INFINITY = 1.0 / 0.0;
public static final double NEGATIVE_INFINITY = -1.0 / 0.0;
public static final double NaN = 0.0d / 0.0;
```

### Character
Unicode给每个字符分配了一个类型,这个类型非常重要,很多其他检查和操作是基于这个类型的。

![字符类型](resources/images/字符类型.png)

常见检测API:
```java
//获取字符类型(general category)：

public static int getType(int codePoint)
public static int getType(char ch)

//检查字符是否为数字,可检测全角数字

public static boolean isDigit(int codePoint)

//检查是否为字母(Letter)：

public static boolean isLetter(int codePoint)
//如果getType()的返回值为下列之一，则为Letter：

//UPPERCASE_LETTER
//LOWERCASE_LETTER
//TITLECASE_LETTER
//MODIFIER_LETTER
//OTHER_LETTER

//检查是否为字母或数字

public static boolean isLetterOrDigit(int codePoint)

//检查是否为字母(Alphabetic)

public static boolean isAlphabetic(int codePoint)
/*这也是检查是否为字母，与isLetter的区别是，
isLetter返回true时，isAlphabetic也必然返回true，
此外，getType()值为LETTER_NUMBER时，isAlphabetic也返回true，
而isLetter返回false。Letter_NUMBER中常见的字符有罗马数字字符，如：'Ⅰ','Ⅱ','Ⅲ','Ⅳ'。*/

//检查是否为空格字符

public static boolean isSpaceChar(int codePoint)
/*getType()值为SPACE_SEPARATOR，LINE_SEPARATOR和PARAGRAPH_SEPARATOR时，返回true。
这个方法其实并不常用，因为它只能严格匹配空格字符本身，不能匹配实际产生空格效果的字符，如tab控制键'\t'。*/

//更常用的检查空格的方法

public static boolean isWhitespace(int codePoint) 
//'\t'，'\n'，全角空格'　'，和半角空格' '的返回值都为true。

//检查是否为小写字符

public static boolean isLowerCase(int codePoint) 

//检查是否为大写字符

public static boolean isUpperCase(int codePoint)

//检查是否为表意象形文字

public static boolean isIdeographic(int codePoint) 
//大部分中文都返回为true。

//检查是否为ISO 8859-1编码中的控制字符

public static boolean isISOControl(int codePoint) 
//0到31，127到159表示控制字符。

//检查是否可作为Java标示符的第一个字符

public static boolean isJavaIdentifierStart(int codePoint) 
/*Java标示符是Java中的变量名、函数名、类名等，
字母(Alphabetic)，美元符号($)，下划线(_)可作为Java标示符的第一个字符，但数字字符不可以。*/

//检查是否可作为Java标示符的中间字符

public static boolean isJavaIdentifierPart(int codePoint) 
//相比isJavaIdentifierStart，主要多了数字字符，中间可以有数字。

//检查是否为镜像(mirrowed)字符

public static boolean isMirrored(int codePoint)
//常见镜像字符有( ) { } < > [ ]，都有对应的镜像。
```

常见转换API:
```java
public static int toLowerCase(int codePoint);
public static int toUpperCase(int codePoint);

//返回字符表示的数值(a-z,返回10-35无论全角还是半角)
public static int getNumberValue(int codePoint);
//返回给定进制表示
public static int digit(int codePoint,int radix);
//返回数值的字符形式
public static char forDigit(int digit,int radix);
```

## 剖析String
内部用一个字符数组表示字符串:private final char value[];

String声明为final,具有不可变性。对String的修改都是重新创建了新字符串。

字符串常量就是String类型的对象,在内存中,它们被放在一个共享的地方,这个地方被称作常量池,因此可以使用字符串的函数

```js
//String常量赋值
String name1 = new String("常量");
String name2 = new String("常量");
name1 == name2;//false
name1.equals(name2);//true
```

与正则表达式相关的方法
```js
public String[] split(String regex);
public boolean matches(String regex);
public String replace(String regex,String replacement);
public String replaceAll(String regex,String replacement);
```

## 剖析StringBuilder
StringBuilder和StringBuffer类,这两个类的方法基本完全一样,而StringBuffer是线程安全的,StringBuilder不是。append的实现机制是通过数组的复制(Arrays.copyOf(oriArr,tarArr))来扩大内部的char数组的

+和+=用字符串对象生成StringBuilder对象调用append后再调用toString()方法转为String对象

## 剖析Arrays
Arrays.toString(Object[] a)返回各项toString的值,如:{1,2,3} -> [1,2,3]
Arrays.sort(int[] a[, Comparator<? super T> c])默认为升序排序,可指定一个对象设置排序规则。使用了策略模式，排序基本步骤和算法不变，排序的策略却会改变。

对于多维数组,数组的第一维必须初始化,多维数组操作的API:
```js
public static String deepToString(Object[] a);
public static boolean deepEquals(Object[] a1, Object[] a2);
public static int deepHashCode(Object a[]);
```

## 剖析日期和时间
### 基本概念
所有计算机系统内部都用一个整数表示时刻，这个整数是距离格林尼治标准时间1970年1月1日0时0分0秒的毫秒数

纪元时:格林尼治标准时间1970年1月1日0时0分0秒也被称为Epoch Time (纪元时)。

时刻是一个绝对时间，对时刻的解读，如年月日周时分秒等，则是相对的，与年历和时区相关

Java API表示日期和时间的类:
- Date：表示时刻，即绝对时间，与年月日无关。
- Calendar：表示年历，Calendar是一个抽象类，其中表示公历的子类是GregorianCalendar
- DateFormat：表示格式化，能够将日期和时间与字符串进行相互转换，DateFormat也是一个抽象类，其中最常用的子类是SimpleDateFormat。
- TimeZone: 表示时区
- Locale: 表示国家和语言

### Date
常用API:
```js
//返回毫秒数
public long getTime();
//与其他Date进行比较
public int compareTo(Date anotherDate);
public boolean before(Date when);
public boolean after(Date when);
```

### Calendar
常用API
```js
//创建
public static Calendar getInstance()
public static Calendar getInstance(Locale aLocale)
public static Calendar getInstance(TimeZone zone)
public static Calendar getInstance(TimeZone zone, Locale aLocale)

//获取
calendar.get(Calendar.YEAR);

//设置
public final void setTime(Date date);
public void setTimeInMillis(long millis);
public final void int set(int year,int month,int date,int hour,int minute,int second);
public void set(int field, int value)


//增加或减少时间
public void add(int field, int amount)
//增加或减少时间,但不影响更大范围的值
public void roll(int field, int amount)
```

### DateFormat
DateFormat(主要方法format,parse),DateFormat是个抽像类，一般使用SimpleDateFormat

SimpleDateFormat使用一个模式作为参数,该模式定义了Date的字符串形式。

pattern中的英文字符a-z和A-Z表示特殊含义，其他字符原样输出:
- yyyy：表示四位的年
- MM：表示月，两位数表示
- dd：表示日，两位数表示
- HH：表示24小时制的小时数，两位数表示
- mm：表示分钟，两位数表示
- ss：表示秒，两位数表示
- E：表示星期几
- SSS: 表示毫秒,三位数表示

SimpleDateFormat非线程安全的

## Joda-Time
Joda-Time是Apache提供的时间日期的工具类

### DateTime
```java
//创建对象
DateTime dt = new DateTime();
//2016-08-18 15:20:47
DateTime dt2 = new DateTime(2016,8,18,15,20,47);

//获取
dt.getYear();

//格式化
dt.toString("yyyy-MM-dd HH:mm:ss");

//设置时间
dt.withHourOfDay(15);
//增加时间
dt.plusWeeks(1);
//减少时间
dt.minusMinutes(1);
//设置为当天最后一刻
DateTime dt = new DateTime().millisOfDay().withMaximumValue();
/*
millisOfDay()的返回值比较特别，它是一个属性，
具体类为DateTime的一个内部类Property，这个属性代表当天毫秒信息，
这个属性有一些方法，可以接着对日期进行修改，
withMaximumValue就是将该属性的值设为最大值。
 */
```

### 时间段计算
```js
DateTime start = new DateTime(2016,8,18,10,58);
DateTime end = new DateTime(2016,9,19,12,3);
Period period = new Period(start,end);        
System.out.println(period.getMonths()+"月"+period.getDays()+"天"
        +period.getHours()+"小时"+period.getMinutes()+"分");
//结果为 1月1天1小时5分
```

## 随机
Random常用函数nextInt(int range);位于java.util包下;线程安全的

设置随机种子`public Random(long seed);`

种子决定了随机产生的序列,种子相同,产生的随机序列数就是相同的。

Math.rondom()内部也是通过Random对象生成随机数