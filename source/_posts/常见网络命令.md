title: Windows下常用网络命令
tags:
    - 网络
    - 工具
comments: true
brief: Windows下常用网络命令
date: 2019-05-30
copyright: true
photos:
    - "https://cdn.pixabay.com/photo/2012/02/29/12/26/space-19070_960_720.jpg"
categories:
    - 网络
---

介绍一些Windows下的常用网络命令，用于网络故障的分析和排查。不求全部记下，但求留个印象，在网络出现问题时能够想到有这些个工具。

环境：

- CMD版本：10.0.17134.766
- 系统：Windows 10 家庭版（OS 内部版本 17134.766）

<!-- more -->

## ping
ping是用于判断两个电脑的IP层是否连通的一个工具，通过发送一个ICMP回显报文，如果两电脑连接，该报文将会被返回。否则ICMP错误报文。

__基本使用__
ping 主机名/域名/ip

```bash
ping xx-pc #主机名
ping 192.168.0.205 #ip
ping baidu.com #域名
```

__大小、次数、跳跃数、时间__

```shell
# 发送缓冲包大小,默认32，最大65527
ping /l 1000 10.0.99.221

# 发送次数，默认四次
ping /n 10 10.0.99.221
# 一直发送直到中断
ping /t 10.0.99.221

# 设置TTL值（可认为是允许中转路由数，即跳跃数），默认是IP协议默认的TTL值
ping /i 10 10.0.99.221

# 等待的时间，单位毫秒
ping /w 10 10.0.99.221
```

__宽松选路/严格选路__
到达目的地址前需要经过的一些地址，严格选路是严格按照地址顺序，宽松选路是只需要经过地址即可（即每个地址之间可以经过很多其他地址）。由于IP报文自身的限制，最多可指定的地址列表为9个。

```shell
# 宽松选路
ping /j 10.12.0.1 10.29.3.1 10.1.44.1 10.0.99.221
# 严格选路
ping /k 10.12.0.1 10.29.3.1 10.1.44.1 10.0.99.221
```

测试了下，并不成功，mac系统上对应的命令，没有这类选项，难道是不支持了「(°ヘ°)。

## ipconfig
用于显示当前TCP/IP网络配置以及刷新DHCP和DNS设置。

__显示__

```bash
# 显示所有网络适配器（包括虚拟机）的基本信息：
#     适配器名、IPv4、IPv6、子网掩码、默认网关
ipconfig
# 显示所有适配器的全部信息，基本信息加上：
#    物理地址、DHCP是否启用、自动配置是否启用、DNS 服务器
#    DHCPv6 IAID、 DHCPv6 客户端 DUID、TCPIP 上的 NetBIOS
ipconfig /all
# 显示 DNS 解析程序缓存的内容。
ipconfig /displaydns
```

__修改__

```bash
# 清除 DNS 解析程序缓存
ipconfig /flushdns
# 更新指定适配器的 IPv4 地址，名称可用通配符
ipconfig /renew "Local*"
# 刷新所有 DHCP 租用并重新注册 DNS 名称
ipconfig /registerdns
```

## netstat
显示协议统计信息和当前 TCP/IP 网络连接

__连接信息__

```bash
# 显示所有连接和监听，实时显示
netstat -a
# 每个连接或监听所涉及的执行程序
netstat -b
# 显示 proto 指定的协议的连接（TCP、UDP、TCPv6、UDPv6）
netstat -p proto      
```

__路由表__

```bash
# 显示路由表，包括：IPv4、IPv6、默认路由、接口列表
netstat -r
```

__统计信息__

```bash
# 显示每个协议统计(IP4、IP6的：IP、ICMP、TCP、UDP)信息
# 加上p参数可以指定协议
netstat -s
# 显示以太网统计信息
netstat -e
```

## route
路由表相关命令

```bash
# 显示路由表
route print
```
还有手动添加、修改、删除的命令，感觉用处不大，用的时候再去查吧，就不一一介绍了。

## nslookup
显示DNS相关信息

```bash
# 使用默认服务器的交互模式
nslookup            
# 使用 "server" (对应的DNS服务器)的交互模式
nslookup - server    
# 仅查找使用默认服务器的 "host"(域名)
nslookup host        
# 仅查找使用 "server" 的 "host"
nslookup host server
```

## tracert
跟踪路由信息，基于ICMP回显报文和UDP端口错误，等价于traceroute程序。

- `-h maximum_hops`  搜索目标的最大跃点数。
- `-j host-list`     与主机列表一起的松散源路由(仅适用于 IPv4)。跟ping一样，但同样无法使用，原因未知。
- `-w timeout`       等待每个回复的超时时间(以毫秒为单位)。

```bash
# 基本使用
tracert www.baidu.com
# 设置跳转次数和时间
tracert -h 10 -w 5 www.baidu.com
# 设置宽松路径
tracert -j 10.1.16.113 www.baidu.com
```

## arp
显示和修改地址解析协议(ARP)使用的“IP 到物理”地址转换表(ARP缓存)。

```bash
# 添加arp缓存项
arp -s inet_addr eth_addr [if_addr]
# 删除arp缓存项
arp -d inet_addr [if_addr]
# 查看arp缓存项
arp -a [inet_addr] [-N if_addr] [-v]
```

- inet_addr：Internet地址（需要发送的IP地址）
- eth_addr：物理地址
- if_addr：指定使用的接口的地址（本机对应的某个IP地址）
- `-N if_addr`：显示指定if_addr的arp缓存
- `-v`：详细模式显示，所有无效项和环回接口上的项都将显示。

    公众号二分之一程序员，专注计算机基础的学习，欢迎关注 :)

<center class="center">![二分之一程序员](/images/qrcode_wechat_office.jpg)</center>